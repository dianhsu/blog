---
title: MIT 6.1810 Operating System Engineering
math: true
date: 2022-09-11 23:32:17
categories:
    - 操作系统
tags:
    - 操作系统
    - 实验
index_img: https://cdn.dianhsu.com/img/2022-09-12-00-20-51.jpeg
---

> Reference: https://pdos.csail.mit.edu/6.1810/2022/index.html

6.1810 是MIT的著名的操作系统课程6.828的后续版本，主要区别是6.828基于x86指令集，6.1810基于risc-v指令集。之前做6.828的时候，因为太菜了，实在是做不下去🥺，一度弃坑。趁着毕业之前还有很多时间，再来一遍，争取这次能够做完这套课程。

# 实验环境设置 
我平常的开发设备是MacBook M1，按照Tools[^1]中的macOS的工具安装方法，安装了risc-v的cross compile编译工具之后，发现并不能编译成功。多次尝试未果之后，果断放弃，选择拥抱远端环境。这次就没有像上次一样用阿里云的服务器了，这次用的是GitHub提供的Codespaces[^2]。这套环境，可以很方便在不同设备上进行使用，可以选择用本地的vscode，也可以选择用浏览器版本的vscode，还可以用ssh连接端口使用vim，超级方便🤣。唯一的不好的地方就是网络差的时候用起来有点卡。

按照Tools[^1]中提供的步骤，在Codespaces[^2]中安装必要的环境和工具。

```bash
sudo apt-get update && sudo apt-get upgrade -y
sudo apt-get install -y git build-essential gdb-multiarch qemu-system-misc gcc-riscv64-linux-gnu binutils-riscv64-linux-gnu 
```
 
# Lab: Xv6 and Unix utilities
这是第一个Lab，主要是熟悉下环境，然后编写几个命令行小工具。

## sleep(easy)
在xv6中实现UNIX当中的sleep函数。

`user/sleep.c`的代码实现如下
```c
/*
    filename: user/sleep.c
*/

#include "kernel/types.h"
#include "user/user.h"

int main(int argc, char *argv[]){
    if(argc != 2){
        exit(0);
    }
    // atoi 是将字符串转换成数字，定义在user/user.h中
    int n = atoi(argv[1]);
    sleep(n);
    exit(0);
}
```
实现完成之后，需要在`Makefile`文件中添加上这个文件生成的执行文件。

```Makefile
UPROGS=\
	$U/_grind\
	$U/_wc\
	$U/_zombie\
	$U/_sleep\  # 新增此行
```
然后在命令行中执行`./grade-lab-util sleep`来检查是否正确。

参考的commit: [https://github.com/dianhsu/xv6-riscv/commit/eee6ab6d5a3c7df8f9f0fff1ac036ae38105ab3a](https://github.com/dianhsu/xv6-riscv/commit/eee6ab6d5a3c7df8f9f0fff1ac036ae38105ab3a)
## pingpong(easy)
在xv6中实现UNIX当中的pingpong函数。

## primes(moderate)

## find(moderate)

## xargs(moderate)


# References
[^1]: [Tools](https://pdos.csail.mit.edu/6.1810/2022/tools.html)
[^2]: [Codespaces](https://github.com/codespaces)