---
title: MIT 6.1810 Operating System Engineering
math: true
date: 2022-09-11 23:32:17
categories:
    - æ“ä½œç³»ç»Ÿ
tags:
    - æ“ä½œç³»ç»Ÿ
    - å®éªŒ
index_img: https://cdn.dianhsu.com/img/2022-09-12-00-20-51.jpeg
---

> Reference: https://pdos.csail.mit.edu/6.1810/2022/index.html

6.1810 æ˜¯MITçš„è‘—åçš„æ“ä½œç³»ç»Ÿè¯¾ç¨‹6.828çš„åç»­ç‰ˆæœ¬ï¼Œä¸»è¦åŒºåˆ«æ˜¯6.828åŸºäºx86æŒ‡ä»¤é›†ï¼Œ6.1810åŸºäºrisc-væŒ‡ä»¤é›†ã€‚ä¹‹å‰åš6.828çš„æ—¶å€™ï¼Œå› ä¸ºå¤ªèœäº†ï¼Œå®åœ¨æ˜¯åšä¸ä¸‹å»ğŸ¥ºï¼Œä¸€åº¦å¼ƒå‘ã€‚è¶ç€æ¯•ä¸šä¹‹å‰è¿˜æœ‰å¾ˆå¤šæ—¶é—´ï¼Œå†æ¥ä¸€éï¼Œäº‰å–è¿™æ¬¡èƒ½å¤Ÿåšå®Œè¿™å¥—è¯¾ç¨‹ã€‚

# å®éªŒç¯å¢ƒè®¾ç½® 
æˆ‘å¹³å¸¸çš„å¼€å‘è®¾å¤‡æ˜¯MacBook M1ï¼ŒæŒ‰ç…§Tools[^1]ä¸­çš„macOSçš„å·¥å…·å®‰è£…æ–¹æ³•ï¼Œå®‰è£…äº†risc-vçš„cross compileç¼–è¯‘å·¥å…·ä¹‹åï¼Œå‘ç°å¹¶ä¸èƒ½ç¼–è¯‘æˆåŠŸã€‚å¤šæ¬¡å°è¯•æœªæœä¹‹åï¼Œæœæ–­æ”¾å¼ƒï¼Œé€‰æ‹©æ‹¥æŠ±è¿œç«¯ç¯å¢ƒã€‚è¿™æ¬¡å°±æ²¡æœ‰åƒä¸Šæ¬¡ä¸€æ ·ç”¨é˜¿é‡Œäº‘çš„æœåŠ¡å™¨äº†ï¼Œè¿™æ¬¡ç”¨çš„æ˜¯GitHubæä¾›çš„Codespaces[^2]ã€‚è¿™å¥—ç¯å¢ƒï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ¨ä¸åŒè®¾å¤‡ä¸Šè¿›è¡Œä½¿ç”¨ï¼Œå¯ä»¥é€‰æ‹©ç”¨æœ¬åœ°çš„vscodeï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ç”¨æµè§ˆå™¨ç‰ˆæœ¬çš„vscodeï¼Œè¿˜å¯ä»¥ç”¨sshè¿æ¥ç«¯å£ä½¿ç”¨vimï¼Œè¶…çº§æ–¹ä¾¿ğŸ¤£ã€‚å”¯ä¸€çš„ä¸å¥½çš„åœ°æ–¹å°±æ˜¯ç½‘ç»œå·®çš„æ—¶å€™ç”¨èµ·æ¥æœ‰ç‚¹å¡ã€‚

æŒ‰ç…§Tools[^1]ä¸­æä¾›çš„æ­¥éª¤ï¼Œåœ¨Codespaces[^2]ä¸­å®‰è£…å¿…è¦çš„ç¯å¢ƒå’Œå·¥å…·ã€‚

```bash
sudo apt-get update && sudo apt-get upgrade -y
sudo apt-get install -y git build-essential gdb-multiarch qemu-system-misc gcc-riscv64-linux-gnu binutils-riscv64-linux-gnu 
```
 
# Lab: Xv6 and Unix utilities
è¿™æ˜¯ç¬¬ä¸€ä¸ªLabï¼Œä¸»è¦æ˜¯ç†Ÿæ‚‰ä¸‹ç¯å¢ƒï¼Œç„¶åç¼–å†™å‡ ä¸ªå‘½ä»¤è¡Œå°å·¥å…·ã€‚

## sleep(easy)
åœ¨xv6ä¸­å®ç°UNIXå½“ä¸­çš„sleepå‡½æ•°ã€‚

`user/sleep.c`çš„ä»£ç å®ç°å¦‚ä¸‹
```c
/*
    filename: user/sleep.c
*/

#include "kernel/types.h"
#include "user/user.h"

int main(int argc, char *argv[]){
    if(argc != 2){
        exit(0);
    }
    // atoi æ˜¯å°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—ï¼Œå®šä¹‰åœ¨user/user.hä¸­
    int n = atoi(argv[1]);
    sleep(n);
    exit(0);
}
```
å®ç°å®Œæˆä¹‹åï¼Œéœ€è¦åœ¨`Makefile`æ–‡ä»¶ä¸­æ·»åŠ ä¸Šè¿™ä¸ªæ–‡ä»¶ç”Ÿæˆçš„æ‰§è¡Œæ–‡ä»¶ã€‚

```Makefile
UPROGS=\
	$U/_grind\
	$U/_wc\
	$U/_zombie\
	$U/_sleep\  # æ–°å¢æ­¤è¡Œ
```
ç„¶ååœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œ`./grade-lab-util sleep`æ¥æ£€æŸ¥æ˜¯å¦æ­£ç¡®ã€‚

å‚è€ƒçš„commit: [https://github.com/dianhsu/xv6-riscv/commit/eee6ab6d5a3c7df8f9f0fff1ac036ae38105ab3a](https://github.com/dianhsu/xv6-riscv/commit/eee6ab6d5a3c7df8f9f0fff1ac036ae38105ab3a)
## pingpong(easy)
åœ¨xv6ä¸­å®ç°UNIXå½“ä¸­çš„pingpongå‡½æ•°ã€‚

## primes(moderate)

## find(moderate)

## xargs(moderate)


# References
[^1]: [Tools](https://pdos.csail.mit.edu/6.1810/2022/tools.html)
[^2]: [Codespaces](https://github.com/codespaces)